# ‚ú® Telethon Fancifier

–¢–µ–ª–µ–≥—Ä–∞–º-–¥–µ–º–æ–Ω –Ω–∞ –±–∞–∑–µ Telethon, –∫–æ—Ç–æ—Ä—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç **–ø–æ—Å–ª–µ–¥–Ω–µ–µ –≤–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ** –≤ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —á–∞—Ç–∞—Ö –ø–æ —Ü–µ–ø–æ—á–∫–µ –º–æ–¥—É–ª–µ–π (–ø–ª–∞–≥–∏–Ω–æ–≤).

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üß© –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: –∫–∞–∂–¥—ã–π –ø–ª–∞–≥–∏–Ω ‚Äî –æ—Ç–¥–µ–ª—å–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞.
- üóÇÔ∏è –ü—Ä–∏–≤—è–∑–∫–∞ –º–æ–¥—É–ª–µ–π –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –≥—Ä—É–ø–ø–∞–º/—Å—É–ø–µ—Ä–≥—Ä—É–ø–ø–∞–º/–∫–∞–Ω–∞–ª–∞–º.
- üíæ –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–µ–∂–¥—É –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–º–∏.
- üß™ –†–µ–∂–∏–º `dry-run`: –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤ –∫–æ–Ω—Å–æ–ª–∏, —á—Ç–æ –±—ã–ª–æ –±—ã –∏–∑–º–µ–Ω–µ–Ω–æ, –±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ Telegram.
- üõ°Ô∏è –ó–∞—â–∏—Ç–∞ –æ—Ç –æ–ø–∞—Å–Ω—ã—Ö –ø—Ä–∞–≤–æ–∫:
  - –Ω–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è —Å—Ç–∞—Ä—à–µ 10 —Å–µ–∫—É–Ω–¥;
  - —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–µ–µ –≤–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Ü–µ–ª–µ–≤–æ–º —á–∞—Ç–µ.
- ü™ü –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ portable-—Ä–µ–ª–∏–∑—É –¥–ª—è Windows (ZIP).

## üì¶ –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –º–æ–¥—É–ª–∏

1. ü§ñ `llm_rewrite` ‚Äî –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ LLM API (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é DeepSeek).
2. **`random_bold`** ‚Äî —Å–ª—É—á–∞–π–Ω–æ –¥–µ–ª–∞–µ—Ç —á–∞—Å—Ç—å —Å–∏–º–≤–æ–ª–æ–≤ –∂–∏—Ä–Ω—ã–º–∏ –≤ markdown.
3. üî† `every_second_upper` ‚Äî –¥–µ–ª–∞–µ—Ç –∫–∞–∂–¥—É—é –≤—Ç–æ—Ä—É—é –±—É–∫–≤—É –∑–∞–≥–ª–∞–≤–Ω–æ–π.

## ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
python -m venv .venv
source .venv/bin/activate  # Windows: .venv\Scripts\activate
pip install -e .
```

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ `.env.example` –≤ `.env` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è:

- `TELEGRAM_API_ID`
- `TELEGRAM_API_HASH`
- `TELEGRAM_SESSION_NAME`
- `DEEPSEEK_API_KEY` (–¥–ª—è LLM-–º–æ–¥—É–ª—è)

## üß≠ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1) –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

```bash
telethon-fancifier setup
```

–ö–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç –º–∞—Å—Ç–µ—Ä –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å –¥–µ–π—Å—Ç–≤–∏—è–º–∏:

- –¥–æ–±–∞–≤–∏—Ç—å/–∏–∑–º–µ–Ω–∏—Ç—å —á–∞—Ç—ã –∏ –ø–æ—Ä—è–¥–æ–∫ –º–æ–¥—É–ª–µ–π;
- —É–¥–∞–ª–∏—Ç—å —á–∞—Ç—ã –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ñ–∏–≥–∞;
- –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.
- –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å LLM: –º–æ–¥–µ–ª—å, API-—Å—Ç–∏–ª—å (`chat_completions`/`responses`), prompt-–ø—Ä–æ—Ñ–∏–ª–∏ –∏ `temperature`.
- –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å LLM (–≤–≤–µ—Å—Ç–∏ —Ç–µ–∫—Å—Ç –∏ —Å—Ä–∞–∑—É —É–≤–∏–¥–µ—Ç—å –æ—Ç–≤–µ—Ç).

–î–ª—è prompt-–ø—Ä–æ—Ñ–∏–ª—è –¥–æ—Å—Ç—É–ø–Ω—ã:

- `system_prompt`;
- `user_prompt_template` (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ placeholder `{text}`);
- –æ—Ç–¥–µ–ª—å–Ω–∞—è `temperature` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ prompt-–ø—Ä–æ—Ñ–∏–ª—è.

### 2) –ó–∞–ø—É—Å–∫ –¥–µ–º–æ–Ω–∞

```bash
telethon-fancifier run
```

### 3) –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π

```bash
telethon-fancifier run --dry-run
```

### 4) –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–µ–∫—É—â–∏—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫

```bash
telethon-fancifier show-config
```

### 5) –ü—Ä–æ–≤–µ—Ä–∫–∞ LLM –±–µ–∑ Telegram

```bash
telethon-fancifier test-llm --text "–ü—Ä–∏–≤–µ—Ç, —ç—Ç–æ —Ç–µ—Å—Ç"
```

–ö–æ–º–∞–Ω–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç LLM-–º–æ–¥—É–ª—å –Ω–∞–ø—Ä—è–º—É—é –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫–æ–π —Ç–µ–∫—Å—Ç –≤–µ—Ä–Ω—ë—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, –Ω–µ –∑–∞–ø—É—Å–∫–∞—è Telegram-–¥–µ–º–æ–Ω.

### 6) –£–¥–∞–ª–µ–Ω–∏–µ —á–∞—Ç–æ–≤ –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫

```bash
telethon-fancifier remove-chats
```

–ö–æ–º–∞–Ω–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–µ–∫—É—â–∏–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ —á–∞—Ç—ã –∏ —É–¥–∞–ª—è–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –ø–æ –Ω–æ–º–µ—Ä–∞–º.

### 7) –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –Ω–∞ —Å—Ç–∞—Ä—Ç–µ Windows (Task Scheduler)

–°–æ–∑–¥–∞—Ç—å/–æ–±–Ω–æ–≤–∏—Ç—å –∑–∞–¥–∞—á—É –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞:

```bash
telethon-fancifier install-startup-task
```

–ó–∞–¥–∞—á–∞ —Å–æ–∑–¥–∞—ë—Ç—Å—è –≤ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–º —Ä–µ–∂–∏–º–µ (`/IT`), –ø–æ—ç—Ç–æ–º—É –æ–∫–Ω–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤–∏–¥–Ω–æ –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞ –≤ —Å–∏—Å—Ç–µ–º—É.

–ü–æ–ª–µ–∑–Ω—ã–µ –æ–ø—Ü–∏–∏:

- `--task-name "TelethonFancifier"` ‚Äî –∏–º—è –∑–∞–¥–∞—á–∏ –≤ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–µ;
- `--project-dir "C:\\path\\to\\telethon-fancifier"` ‚Äî –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –ø—Ä–æ–µ–∫—Ç–∞ —Å `.env`;
- `--dry-run` ‚Äî –∑–∞–ø—É—Å–∫–∞—Ç—å –Ω–∞ —Å—Ç–∞—Ä—Ç–µ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º —Ä–µ–∂–∏–º–µ `run --dry-run`.

–£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞:

```bash
telethon-fancifier remove-startup-task
```

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏:

```bash
telethon-fancifier startup-task-status
```

## üß± –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

- `src/telethon_fancifier/core` ‚Äî daemon, safeguards, markdown-—É—Ç–∏–ª–∏—Ç—ã.
- `src/telethon_fancifier/plugins` ‚Äî –ø–ª–∞–≥–∏–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–∞–∫—Ç, —Ä–µ–µ—Å—Ç—Ä –∏ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ø–ª–∞–≥–∏–Ω—ã.
- `src/telethon_fancifier/providers` ‚Äî –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è LLM-–ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ –∏ –∞–¥–∞–ø—Ç–µ—Ä DeepSeek.
- `src/telethon_fancifier/ui` ‚Äî –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º –Ω–∞—Å—Ç—Ä–æ–µ–∫.
- `plugins/` ‚Äî –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö –º–æ–¥—É–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

## üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```bash
pip install -e .[dev]
ruff check .
mypy src
pytest
```

## üîê –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –∞–∫–∫–∞—É–Ω—Ç—ã –∏ —Å–æ–±–ª—é–¥–∞–π—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ Telegram.
- –ù–µ —Ö—Ä–∞–Ω–∏—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã API –≤ Git.
- –ú–æ–¥—É–ª—å `llm_rewrite` –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–µ–∫—Å—Ç –≤–æ –≤–Ω–µ—à–Ω–∏–π API-–ø—Ä–æ–≤–∞–π–¥–µ—Ä.

## üßæ –õ–æ–≥–∏ –∏ –æ—à–∏–±–∫–∏

- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏ –±–µ–∑ –ø–∞–¥–µ–Ω–∏—è —Å traceback –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ.
- –î–µ—Ç–∞–ª—å–Ω—ã–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏—á–∏–Ω—ã –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ –ª–æ–≥-—Ñ–∞–π–ª.
- –ü—É—Ç—å –∫ –ª–æ–≥—É –≤—ã–≤–æ–¥–∏—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å –ø—Ä–∏ –æ—à–∏–±–∫–µ.
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø—É—Ç—å: `app-data/telethon-fancifier/logs/app.log` (platform-specific).

## ü™ü Portable release –¥–ª—è Windows

–í –ø—Ä–æ–µ–∫—Ç–µ –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω workflow —Å–±–æ—Ä–∫–∏ portable ZIP-–∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞. –°–º. `scripts/build_windows_portable.py` –∏ `.github/workflows/release.yml`.

–õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ —Å–±–æ—Ä–∫–∏:

```bash
pip install pyinstaller
python scripts/build_windows_portable.py
```

–í–∞–∂–Ω–æ: –ª–æ–∫–∞–ª—å–Ω–∞—è —Å–±–æ—Ä–∫–∞ –∏–º–µ–Ω–Ω–æ **Windows** portable –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ Windows.
–ï—Å–ª–∏ –≤—ã –Ω–∞ macOS/Linux, –∑–∞–ø—É—Å–∫–∞–π—Ç–µ workflow `.github/workflows/release.yml` –≤ GitHub Actions.

–ò–ª–∏ —á–µ—Ä–µ–∑ CLI-–æ–±—ë—Ä—Ç–∫—É –ø—Ä–æ–µ–∫—Ç–∞:

```bash
telethon-fancifier build-windows
```

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã: `docs/architecture.md`.

–ü–æ—à–∞–≥–æ–≤—ã–π –∑–∞–ø—É—Å–∫ –¥–æ –ø–µ—Ä–≤–æ–≥–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –ø—Ä–æ–≥–æ–Ω–∞: `docs/first-dry-run.md`.

## ‚ö° Quick update/deploy –¥–ª—è Windows

–ë—ã—Å—Ç—Ä–æ –æ–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–µ–∫—Ç –∏–∑ GitHub (`origin/main`), –æ–±–Ω–æ–≤–∏—Ç—å `.venv` –∏ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞–∫–µ—Ç:

–ï—Å–ª–∏ `origin/main` –±—ã–ª –ø–µ—Ä–µ–ø–∏—Å–∞–Ω (force-push) –∏ –ª–æ–∫–∞–ª—å–Ω–∞—è –≤–µ—Ç–∫–∞ —Ä–∞–∑–æ—à–ª–∞—Å—å, —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Å—Ç backup-–≤–µ—Ç–∫—É (`backup/<branch>-before-reset-<timestamp>`) –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–π `main` —Å `origin/main`.

```powershell
.\scripts\windows_quick_update.ps1
```

–ò–ª–∏ —á–µ—Ä–µ–∑ `.bat`-–æ–±—ë—Ä—Ç–∫—É:

```cmd
scripts\windows_quick_update.bat
```

–ü–æ–ª–µ–∑–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

- `-Branch main` ‚Äî –≤–µ—Ç–∫–∞ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è;
- `-RepoDir "C:\\telethon-fancifier\\telethon-fancifier"` ‚Äî –ø—É—Ç—å –∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é;
- `-ForceUpdate` ‚Äî –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —Å–±—Ä–æ—Å–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å `origin/<branch>`;
- `-RestartStartupTask` ‚Äî –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å startup-–∑–∞–¥–∞—á—É;
- `-TaskName "TelethonFancifier"` ‚Äî –∏–º—è startup-–∑–∞–¥–∞—á–∏;
- `-SkipSmokeTest` ‚Äî –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å `show-config` –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è.

–ü—Ä–∏–º–µ—Ä –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–µ–∑ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –∫–æ–º–º–∏—Ç–æ–≤:

```powershell
.\scripts\windows_quick_update.ps1 -ForceUpdate
```

## üîå –í–Ω–µ—à–Ω–∏–µ –ø–ª–∞–≥–∏–Ω—ã

- –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –º–æ–¥—É–ª–µ–π: `plugins/`.
- –ì–æ—Ç–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä: `plugins/example_reverse.py`.
- –ö–æ–Ω—Ç—Ä–∞–∫—Ç –ø–ª–∞–≥–∏–Ω–∞ –∏ –ø—Ä–∞–≤–∏–ª–∞ –∑–∞–≥—Ä—É–∑–∫–∏: `plugins/README.md`.
